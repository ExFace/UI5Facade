/*!
 * OpenUI5
 * (c) Copyright 2026 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Element","sap/ui/core/InvisibleText","sap/ui/core/Renderer","sap/ui/core/IconPool","sap/ui/core/library","sap/ui/core/Lib","sap/ui/events/KeyCodes","sap/ui/util/openWindow","sap/ui/util/defaultLinkTypes","./NavigationListItemBase"],function(e,t,i,s,n,o,r,a,l,p,c){"use strict";var g=o.TextAlign;var d=o.TextDirection;var h=e.NavigationListItemDesign;var f=o.aria.HasPopup;const u="sap-icon://navigation-right-arrow";const I="sap-icon://navigation-down-arrow";const L=c.extend("sap.tnt.NavigationListItem",{metadata:{library:"sap.tnt",properties:{icon:{type:"sap.ui.core.URI",group:"Misc",defaultValue:""},visible:{type:"boolean",group:"Appearance",defaultValue:true},selectable:{type:"boolean",group:"Behavior",defaultValue:true},href:{type:"sap.ui.core.URI",group:"Data",defaultValue:null},target:{type:"string",group:"Behavior",defaultValue:null},design:{type:"sap.tnt.NavigationListItemDesign",group:"Behavior",defaultValue:h.Default},ariaHasPopup:{type:"sap.ui.core.aria.HasPopup",group:"Accessibility",defaultValue:f.None}},defaultAggregation:"items",aggregations:{items:{type:"sap.tnt.NavigationListItem",multiple:true,singularName:"item"}},events:{select:{parameters:{item:{type:"sap.ui.core.Item"}}}},designtime:"sap/tnt/designtime/NavigationListItem.designtime"}});L._getInvisibleText=function(){if(!this._invisibleText){this._invisibleText=(new i).toStatic();this._invisibleText.setText(r.getResourceBundleFor("sap.tnt").getText("NAVIGATION_LIST_EXTERNAL_LINK_DESCRIPTION"))}return this._invisibleText};L.prototype._getInvisibleDescriptionLinkText=function(){const e=[];e.push(this.getText());if(!this._invisibleDescriptionLinkText){this._invisibleDescriptionLinkText=new i({id:this.getId()+"-invDescribedbyText",text:this._resourceBundleTnt.getText("NAVIGATION_LIST_KEYBOARD_NAVIGATION",e)}).toStatic()}return this._invisibleDescriptionLinkText};L.prototype.exit=function(){if(this._invisibleDescriptionLinkText){this._invisibleDescriptionLinkText.destroy();this._invisibleDescriptionLinkText=null}c.prototype.exit.apply(this,arguments)};L.prototype.createListForPopup=function(){const e=this.getItems(),t=this.getNavigationList(),i=t.getSelectedItem();let s;const n=e.filter(e=>e.getVisible()).map(e=>{const t=new L({key:e.getId(),text:e.getText(),textDirection:e.getTextDirection(),enabled:e.getEnabled(),selectable:e.getSelectable(),href:e.getHref(),target:e.getTarget(),tooltip:e.getTooltip()});if(i===e){s=t}return t});const o=new L({expanded:true,hasExpander:false,selectable:this.getSelectable(),key:this.getId(),text:this.getText(),enabled:this.getEnabled(),textDirection:this.getTextDirection(),href:this.getHref(),target:this.getTarget(),tooltip:this.getTooltip(),items:n});const r=t.getMetadata().getClass().prototype.constructor;const a=new r({itemSelect:this.onPopupItemSelect.bind(this),itemPress:this.onPopupItemPress.bind(this),items:o}).addStyleClass("sapTntNLPopup");if(i==this){s=o;a.isGroupSelected=true}a.setSelectedItem(s);return a};L.prototype.onPopupItemSelect=function(e){const i=e.getParameter("item"),s=t.getElementById(i.getKey());s._selectItem()};L.prototype.onPopupItemPress=function(e){const i=e.getParameter("item"),s=t.getElementById(i.getKey());if(!s._firePress(e,s)){e.preventDefault()}};L.prototype._selectItem=function(){const e={item:this};this.fireSelect(e);if(this.getSelectable()){this.getNavigationList()._selectItem(e)}this._openUrl()};L.prototype._openUrl=function(){const e=this.getHref();if(e){l(e,this.getTarget()||"_self")}};L.prototype.ontap=function(e){if(c.prototype.ontap.apply(this,arguments)){return}e.preventDefault();if(this.getLevel()>0){if(this.getEnabled()&&this.getAllParentsEnabled()){this._selectItem()}return}const t=this.getNavigationList();if(t.getExpanded()||!this.getItems().length){this._selectItem()}else{const e=this.createListForPopup();t._openPopover(this,e)}};L.prototype.onkeydown=function(e){if(e.isMarked("subItem")){return}if(e.key?e.key==="Enter":e.keyCode===a.ENTER){this.ontap(e)}c.prototype.onkeydown.apply(this,arguments)};L.prototype.onkeyup=function(e){if(e.isMarked("subItem")){return}if(e.key?e.key===" ":e.keyCode===a.SPACE){this.ontap(e)}if(e.srcControl.getLevel()===1){e.setMarked("subItem")}};L.prototype.render=function(e,t){if(!this.getVisible()){return}if(this.getLevel()===0){this.renderFirstLevelNavItem(e,t)}else{this.renderSecondLevelNavItem(e,t)}};L.prototype.renderFirstLevelNavItem=function(e,t){const i=this._getVisibleItems(this),s=this._isListExpanded(),n=this.getEnabled()||this.getAllParentsEnabled();e.openStart("li",this).attr("role","none");if(!s){if(i.length&&n){e.class("sapTntNLINotExpandedTriangle")}if(this._isOverflow){e.class("sapTntNLOverflow").class("sapTntNLIHidden")}}e.openEnd();const o=`${this.getId()}-subtree`;this.renderMainElement(e,t,o);if(s&&i.length){e.openStart("ul",o).class("sapTntNLIItemsContainer").accessibilityState({role:"group",label:this.getText()});if(!this.getExpanded()&&!this._animateCollapse||this._animateExpand){e.class("sapTntNLIItemsContainerHidden")}e.openEnd();i.forEach(i=>i.render(e,t));e.close("ul")}e.close("li")};L.prototype._renderExternalLinkIcon=function(e){const t=this._getExternalIcon();e.renderControl(t)};L.prototype.renderMainElement=function(e,t,i){const s=this._isListExpanded(),n=this._getVisibleItems(this),o=!this.getEnabled()||!this.getAllParentsEnabled(),r=this.getExpanded(),a=this.getSelectable(),l=this.getDesign(),p=!!n.length&&this.getHasExpander(),c=this.getHref()&&this.getTarget()==="_blank";e.openStart("div").class("sapTntNLI").class("sapTntNLIFirstLevel");if(o){e.class("sapTntNLIDisabled")}if(c){e.class("sapTntNLIExternalLink")}let g=false;if(a&&t._selectedItem===this){e.class("sapTntNLISelected");g=true}if((!s||!r)&&n.includes(t._selectedItem)){e.class("sapTntNLISelected");g=true}if(p){e.class("sapTntNLIWithExpander")}if(a&&n.length){e.class("sapTntNLITwoClickAreas")}const d={};if(this.getAriaHasPopup()!==f.None){d.haspopup=this.getAriaHasPopup()}if(l===h.Action){e.class("sapTntNLIAction")}if(!a){e.class("sapTntNLIUnselectable")}if(this._isInsidePopover()){e.class("sapTntNLIInPopover")}if(!s){d.role=a?"menuitemradio":"menuitem";if(n.length){d.haspopup="tree"}if(this._isOverflow){d.haspopup="menu";d.label=this._resourceBundleTnt.getText("NAVIGATION_LIST_OVERFLOW_ITEM_LABEL")}if(a){d.checked=t._selectedItem===this;d.selected=g}else{d.selected=false}d.roledescription=this._resourceBundleTnt.getText("NAVIGATION_LIST_ITEM_ROLE_DESCRIPTION_MENUITEM")}else{if(this.getSelectable()&&this.getItems().length){d.describedby=this._getInvisibleDescriptionLinkText().getId()}d.role="treeitem";if(a){d.selected=g}else{d.selected=false}if(g){d.current="page"}if(n.length){d.owns=i;d.expanded=r}}e.openEnd();this._renderStartLink(e,d,o);this._renderIcon(e);this._renderText(e);if(c){this._renderExternalLinkIcon(e)}if(s){const t=this._getExpandIconControl();t.setVisible(p).setSrc(r?I:u).setTooltip(this._getExpandIconTooltip(!r));e.renderControl(t)}if(!s&&this.getItems().length){const t=this._getExpandIconControl().setSrc(u);e.renderControl(t)}this._renderCloseLink(e);e.close("div")};L.prototype.renderSecondLevelNavItem=function(e,t){const i=!this.getEnabled()||!this.getAllParentsEnabled(),s=this.getHref()&&this.getTarget()==="_blank";e.openStart("li",this).class("sapTntNLI").class("sapTntNLISecondLevel").attr("role","none");let n=false;if(this.getSelectable()&&t._selectedItem===this){e.class("sapTntNLISelected");n=true}if(i){e.class("sapTntNLIDisabled")}if(s){e.class("sapTntNLIExternalLink")}if(this._isInsidePopover()){e.class("sapTntNLIInPopover")}e.openEnd();const o={role:"treeitem",current:this._isListExpanded()&&n?"page":undefined,selected:n};this._renderStartLink(e,o,i);this._renderIcon(e);this._renderText(e);if(s){this._renderExternalLinkIcon(e)}this._renderCloseLink(e);e.close("li")};L.prototype._renderStartLink=function(e,t,i){const s=this.getHref(),n=this.getTarget();e.openStart("a",`${this.getId()}-a`).accessibilityState(this,{...t});const o=this.getTooltip_AsString();if(o){e.attr("title",o)}if(i){e.attr("aria-disabled","true")}e.attr("tabindex","-1");if(s){e.attr("href",s)}if(n){e.attr("target",n).attr("rel",p("",n))}if(s&&n==="_blank"){const t=L._getInvisibleText();e.attr("aria-describedby",t.getId())}e.openEnd()};L.prototype._renderCloseLink=function(e){e.close("a")};L.prototype._renderIcon=function(e){const t=this.getIcon(),i=n.getIconInfo(t);e.openStart("span").class("sapUiIcon").class("sapTntNLIIcon").attr("aria-hidden","true");if(t){if(i&&!i.suppressMirroring){e.class("sapUiIconMirrorInRTL")}if(i){e.attr("data-sap-ui-icon-content",i.content).style("font-family",`'${i.fontFamily}'`)}}e.openEnd().close("span")};L.prototype._renderText=function(e){e.openStart("span").class("sapMText").class("sapTntNLIText");const t=this.getDesign()===h.Action;const i=this._isListExpanded();if(t||!i){e.class("sapMTextNoWrap")}const n=this.getTextDirection();if(n!==d.Inherit){e.attr("dir",n.toLowerCase())}const o=s.getTextAlign(g.Begin,n);if(o){e.style("text-align",o)}e.openEnd().text(this.getText()).close("span")};L.prototype._toggle=function(e){const t=this.getNavigationList(),i=this._isListExpanded();if(!t||!t.getDomRef()){return}const s=this.getDomRef();if(this.getLevel()===0){const t=s?.querySelector(".sapTntNLIFirstLevel");t?.classList.toggle("sapTntNLISelected",e)}if(this.getLevel()!==0){if(i){s?.classList.toggle("sapTntNLISelected",e)}else{const t=this.getParent().getDomRef()?.querySelector(".sapTntNLIFirstLevel");t?.classList.toggle("sapTntNLISelected",e);if(e){t?.classList.toggle("sapTntNLINoHoverEffect",e)}}}this._syncAriaAttributes(this.getFocusDomRef(),e,i);t._closePopover()};L.prototype._syncAriaAttributes=function(e,t,i){if(!e){return}if(i){if(t){e.setAttribute("aria-current","page");e.setAttribute("aria-selected","true")}else{e.removeAttribute("aria-current");e.setAttribute("aria-selected","false")}}else{e.setAttribute("aria-checked",t?"true":"false")}};L.prototype._getFocusDomRefs=function(){const e=[];if(!this.getVisible()){return e}if(!this._isInsidePopover()||this.getSelectable()&&this.getLevel()===0){e.push(this.getDomRef("a"))}if(this._isListExpanded()&&this.getExpanded()){e.push(...this.getDomRef().querySelectorAll(".sapTntNLISecondLevel a"))}return e};L.prototype._getVisibleItems=function(e){return e.getItems().filter(e=>e.getVisible())};L.prototype.onclick=function(e){if(this.getHref()){e.preventDefault()}};L.prototype.onmousedown=function(e){if(this.getHref()){e.preventDefault()}};L.prototype._removeHoverEffect=function(){var e=this.getDomRef()?.querySelector(".sapTntNLIFirstLevel");if(e){e.classList.remove("sapTntNLINoHoverEffect")}};L.prototype.onfocusout=function(){this._removeHoverEffect()};L.prototype.onmouseout=function(e){c.prototype.onmouseout.call(this,e);const t=this.getDomRef()?.querySelector(".sapTntNLIFirstLevel");const i=this.getNavigationList();const s=this.getItems().find(e=>e===i.getSelectedItem());if(t&&(this===i.getSelectedItem()||s)){t.classList.add("sapTntNLINoHoverEffect")}};L.prototype.onmouseover=function(e){c.prototype.onmouseover.call(this,e);this._removeHoverEffect()};return L});
//# sourceMappingURL=NavigationListItem.js.map