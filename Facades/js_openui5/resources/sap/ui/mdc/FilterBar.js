/*!
 * OpenUI5
 * (c) Copyright 2026 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/mdc/p13n/subcontroller/FilterController","sap/ui/mdc/p13n/subcontroller/AdaptFiltersController","sap/ui/mdc/filterbar/FilterContainer","sap/ui/mdc/filterbar/aligned/FilterItemLayout","sap/ui/mdc/filterbar/FilterBarBase","sap/ui/mdc/filterbar/FilterBarBaseRenderer","sap/m/library","sap/m/Button","sap/base/util/merge","sap/base/Log","sap/ui/mdc/enums/FilterBarP13nMode","sap/base/strings/formatMessage"],(t,e,i,r,s,o,n,l,a,d,h,p)=>{"use strict";const u=s.extend("sap.ui.mdc.FilterBar",{metadata:{designtime:"sap/ui/mdc/designtime/filterbar/FilterBar.designtime",properties:{showAdaptFiltersButton:{type:"boolean",defaultValue:true},showClearButton:{type:"boolean",defaultValue:false},p13nMode:{type:"sap.ui.mdc.enums.FilterBarP13nMode[]"},_p13nModeItem:{type:"boolean",visibility:"hidden",defaultValue:false},enableLegacyUI:{type:"boolean",defaultValue:false},adaptFiltersText:{type:"string"},adaptFiltersTextNonZero:{type:"string"}}},renderer:o});const{ButtonType:_}=n;u.prototype._createInnerLayout=function(){this._cLayoutItem=r;this._oFilterBarLayout=new i;this.setAggregation("layout",this._oFilterBarLayout,true);this._addButtons()};u.prototype.setP13nMode=function(i){this.setProperty("p13nMode",i||[],false);const r={helper:this.getPropertyHelper(),controller:{}};let s=false;i&&i.forEach(t=>{if(t=="Item"){s=true;r.controller["Item"]=new e({control:this})}});this._setP13nModeItem(s);r.controller["Filter"]=new t({control:this});this.getEngine().register(this,r);return this};u.prototype.setFilterConditions=function(e,i){t.checkConditionOperatorSanity(e);if(this._oP13nFB){this._oP13nFB.setFilterConditions(a({},e))}this.setProperty("filterConditions",e,i);return this};u.prototype._getP13nModeItem=function(){return this._oModel.getProperty("/_p13nModeItem")};u.prototype._setP13nModeItem=function(t){this._oModel.setProperty("/_p13nModeItem",t,true)};u.prototype._addButtons=function(){this.setProperty("_filterCount",this._oRb.getText("filterbar.ADAPT"),false);this._btnAdapt=new l(this.getId()+"-btnAdapt",{type:_.Transparent,text:"{"+s.INNER_MODEL_NAME+">/_filterCount}",press:this.onAdaptFilters.bind(this)});this._btnAdapt.bindProperty("visible",{parts:[{path:"/showAdaptFiltersButton",model:s.INNER_MODEL_NAME},{path:"/_p13nModeItem",model:s.INNER_MODEL_NAME}],formatter:function(t,e){return t&&e}});this._btnSearch=this._getSearchButton();this._btnSearch.bindProperty("visible",{parts:[{path:"/showGoButton",model:s.INNER_MODEL_NAME},{path:"/liveMode",model:s.INNER_MODEL_NAME}],formatter:function(t,e){return t&&(this._isPhone()?true:!e)}.bind(this)});this._btnSearch.addStyleClass("sapUiMdcFilterBarBaseButtonPaddingRight");this._btnClear=new l(this.getId()+"-btnClear",{type:_.Transparent,visible:"{"+s.INNER_MODEL_NAME+">/showClearButton}",text:this._oRb.getText("filterbar.CLEAR"),press:function(t){this.onClear()}.bind(this)});if(this._oModel){this._btnSearch.setModel(this._oModel,s.INNER_MODEL_NAME);this._btnClear.setModel(this._oModel,s.INNER_MODEL_NAME);this._btnAdapt.setModel(this._oModel,s.INNER_MODEL_NAME)}this._oFilterBarLayout.addButton(this._btnSearch);this._oFilterBarLayout.addButton(this._btnClear);this._oFilterBarLayout.addButton(this._btnAdapt)};u.prototype._getButtons=function(){return this._oFilterBarLayout.getButtons()};u.prototype.onClear=function(){this._btnClear.setEnabled(false);this.awaitControlDelegate().then(t=>{t.clearFilters(this).catch(t=>{d.error(t)}).finally(()=>{this._btnClear.setEnabled(true)})})};u.prototype.retrieveInbuiltFilter=function(){const t=s.prototype.retrieveInbuiltFilter.apply(this,arguments);return t.then(t=>t)};u.prototype.onAdaptFilters=function(t){return this._retrieveMetadata().then(()=>this.getEngine().show(this,"Item",{reset:function(){this.getEngine().reset(this);this._getConditionModel().checkUpdate(true)}.bind(this),open:()=>{const t=this.getInbuiltFilter();if(t&&this._checkIsNewUI()){t._validateAdaptationState()}}}).then(t=>{this._aAddedFilterFields=[];this._aRemovedFilterFields=[];t.attachEventOnce("close",this._determineFilterFieldOnFocus.bind(this));return t}).then(t=>{t.attachEventOnce("close",t=>{this.cleanUpAllFilterFieldsInErrorState();const e=t.getParameter("reason");if(e==="Filter"){this.triggerSearch()}});return t}))};u.prototype._determineFilterFieldOnFocus=function(){let t=null;const e=this.getFilterItems();if(this._aAddedFilterFields&&this._aAddedFilterFields.length>0){[t]=this._aAddedFilterFields;for(let i=1;i<this._aAddedFilterFields.length;i++){if(e.indexOf(t)>e.indexOf(this._aAddedFilterFields[i])){t=this._aAddedFilterFields[i]}}}else if(this._aRemovedFilterFields&&this._aRemovedFilterFields.length>0){[t]=e}if(t){this._setFocusOnFilterField(t)}this._aAddedFilterFields=undefined;this._aRemovedFilterFields=undefined};u.prototype.getAdaptFiltersButtonText=function(t){let e=s.prototype.getAdaptFiltersButtonText.call(this,t);const i=this.getAdaptFiltersText(),r=this.getAdaptFiltersTextNonZero();if(i&&r){e=t?p(r,[t]):i}return e};u.prototype._handleAddedFilterField=function(t){if(this._aAddedFilterFields&&this._aRemovedFilterFields){const e=this._aRemovedFilterFields.indexOf(t);if(e<0){this._aAddedFilterFields.push(t)}else{this._aRemovedFilterFields.splice(e,1)}}};u.prototype._handleRemovedFilterField=function(t){if(this._aRemovedFilterFields){this._aRemovedFilterFields.push(t)}};u.prototype._setFocusOnFilterField=function(t){if(t){t.focus()}};u.prototype.getCurrentState=function(){const t=s.prototype.getCurrentState.apply(this,arguments);if(!this.getProperty("_p13nModeItem")){delete t.items}return t};u.prototype._checkIsNewUI=function(){if(this._bUseNewUI===undefined){this._bUseNewUI=new URLSearchParams(window.location.search).get("sap-ui-xx-new-adapt-filters")==="true"}return this._bUseNewUI};u.prototype.exit=function(){s.prototype.exit.apply(this,arguments);this._btnClear=undefined};return u});
//# sourceMappingURL=FilterBar.js.map