/*!
 * OpenUI5
 * (c) Copyright 2026 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./SelectionController","sap/ui/core/Lib","sap/m/library","sap/ui/mdc/p13n/P13nBuilder","sap/base/util/merge","sap/m/Button"],(t,e,n,o,i,r)=>{"use strict";const{ButtonType:a}=n;const s=t.extend("sap.ui.mdc.p13n.subcontroller.AdaptFiltersController",{constructor:function(){t.apply(this,arguments);this._bResetEnabled=true}});s.prototype.getUISettings=function(){return{verticalScrolling:false,title:e.getResourceBundleFor("sap.ui.mdc").getText("filterbar.ADAPT_TITLE"),afterClose:function(t){const e=t.getSource();if(e){e.getContent()[0].executeRemoves();e.removeAllContent();e.destroy()}}}};s.prototype.getBeforeApply=function(){const t=this.getAdaptationControl().getInbuiltFilter();const e=t?t.createConditionChanges():Promise.resolve([]);return e};s.prototype.getFilterControl=function(){return this.getAdaptationControl()};s.prototype.getChangeOperations=function(){return{add:"addFilter",remove:"removeFilter",move:"moveFilter",additional:["addCondition","removeCondition"]}};s.prototype.enhancePopup=function(t){const e=new URLSearchParams(window.location.search).get("sap-ui-xx-new-adapt-filters")==="true";if(e){const e=new r({text:"Filter",press:()=>{const e=this.getAdaptationControl().getInbuiltFilter();if(!e){return}e.cleanUpAllFilterFieldsInErrorState();e.validate(true).then(e=>{t._onClose(null,"Filter")}).catch(()=>{})},type:a.Ghost});t.insertAdditionalButton(e,1)}};s.prototype.initAdaptationUI=function(t){return this.getAdaptationControl().retrieveInbuiltFilter().then(n=>{const o=this.mixInfoAndState(t);n.getTitle=function(){return e.getResourceBundleFor("sap.ui.mdc").getText("filterbar.ADAPT_TITLE")};this._oPanel=n;n.setP13nData(o);n.setLiveMode(false);n._determineValidationState();return n.createFilterFields().then(()=>n)})};s.prototype.getP13nData=function(){return this._oPanel.getP13nData().items};s.prototype.update=function(t){if(this._oPanel){const e=this.mixInfoAndState(t);this._oPanel.setP13nData(e);this.getAdaptationControl().getInbuiltFilter().createFilterFields()}};s.prototype.mixInfoAndState=function(t){const e=this.getAdaptationControl().getCurrentState().filter||{};const n=this.getCurrentState();const i=o.arrayToMap(n);const r=this.prepareAdaptationData(t,(t,n)=>{const o=i[n.name];const r=e[n.name];t.visible=o?true:false;t.visibleInDialog=true;t.position=o?o.position:-1;t.isFiltered=r&&r.length>0?true:false;t.required=n.required;return!(n.hiddenFilter===true||n.name=="$search")},true);this.sortP13nData({visible:"visible",position:"position"},r.items);return r};return s});
//# sourceMappingURL=AdaptFiltersController.js.map