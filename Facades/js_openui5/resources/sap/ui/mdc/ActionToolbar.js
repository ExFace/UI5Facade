/*!
 * OpenUI5
 * (c) Copyright 2026 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Element","sap/m/OverflowToolbar","sap/m/OverflowToolbarRenderer","sap/m/ToolbarSpacer","sap/m/ToolbarSeparator","sap/m/library","sap/ui/mdc/enums/ActionToolbarActionAlignment","sap/ui/mdc/p13n/subcontroller/ActionToolbarController","sap/m/p13n/Engine","sap/ui/mdc/mixin/AdaptationMixin"],(t,e,o,n,i,r,s,a,g,p)=>{"use strict";const{OverflowToolbarPriority:c}=r;const l=e.extend("sap.ui.mdc.ActionToolbar",{metadata:{library:"sap.ui.mdc",designtime:"sap/ui/mdc/designtime/actiontoolbar/ActionToolbar.designtime",defaultAggregation:"actions",properties:{useAsHeader:{type:"boolean",group:"Behavior",defaultValue:true}},aggregations:{begin:{type:"sap.ui.core.Control",multiple:true},between:{type:"sap.ui.core.Control",multiple:true},actions:{type:"sap.ui.mdc.actiontoolbar.ActionToolbarAction",multiple:true},end:{type:"sap.ui.core.Control",multiple:true},controlActions:{type:"sap.ui.core.Control",multiple:true}}},renderer:o});const u=["begin","between","actions","end","controlActions"];const d=function(){const t={canOverflow:true,getCustomImportance:function(){return c.NeverOverflow}};return t};const h=t=>{const e=t.getLayoutData();if(e?.isA("sap.ui.mdc.IActionLayoutData")){const t=e.getPosition();return`${t}`.split("Actions")[0]}};const f=(t,e)=>{const o=t.getLayoutData();const n=e.getLayoutData();const i=o?.isA("sap.ui.mdc.IActionLayoutData");const r=n?.isA("sap.ui.mdc.IActionLayoutData");if(!i&&!r){return 0}if(i&&!r){return-1}if(!i&&r){return 1}const s=o.getMetadata().getProperty("position").getType().getEnumValues();const a=n.getMetadata().getProperty("position").getType().getEnumValues();const g=Object.getOwnPropertyNames(s).indexOf(o.getPosition());const p=Object.getOwnPropertyNames(a).indexOf(n.getPosition());return g-p};l.ShowGroupSeparators=window.location.search.includes("sap-ui-action-toolbar-separators");l.prototype.init=function(){e.prototype.init.apply(this,arguments);this._oBeginSeparator=new i({visible:false});this._oBeginSeparator.getOverflowToolbarConfig=d;this._oEndActionsBeginSeparator=new i({visible:false});this._oEndActionsBeginSeparator.getOverflowToolbarConfig=d;this._oEndActionsEndSeparator=new i({visible:false});this._oEndActionsEndSeparator.getOverflowToolbarConfig=d;this._oSpacer=new n;this.setUseAsHeader(true);g.getInstance().register(this,{controller:{actionsKey:new a({control:this})}})};l.prototype.exit=function(){e.prototype.exit.apply(this,arguments);if(this._oBeginSeparator){this._oBeginSeparator.destroy()}if(this._oEndActionsBeginSeparator){this._oEndActionsBeginSeparator.destroy()}if(this._oEndActionsEndSeparator){this._oEndActionsEndSeparator.destroy()}if(this._oSpacer){this._oSpacer.destroy()}};l.prototype.addAggregation=function(t,o){if(t==="content"){throw new Error("Mutator functions of the content aggregation of the ActionToolbar '"+this.getId()+"' must not be used.")}const n=arguments;if(u.includes(t)){this._registerControlListener(o);this._resetAndInvalidateToolbar(false);if(o){this._moveControlInSuitableCollection(o,this._getControlPriority(o))}this._informNewFlexibleContentAdded(o);const t=this._callToolbarMethod("addAggregation",n);this._updateSeparators();return t}return e.prototype.addAggregation.apply(this,arguments)};l.prototype.destroyAggregation=function(t){if(t==="content"){throw new Error("Mutator functions of the content aggregation of the ActionToolbar '"+this.getId()+"' must not be used.")}if(u.includes(t)){const e=this.removeAllAggregation(t);for(let t=0;t<e.length;t++){e[t].destroy()}this._updateSeparators();return this}return e.prototype.destroyAggregation.apply(this,arguments)};l.prototype.insertAggregation=function(t,o,n){if(t==="content"){throw new Error("Mutator functions of the content aggregation of the ActionToolbar '"+this.getId()+"' must not be used.")}if(u.includes(t)){this._registerControlListener(o);this._resetAndInvalidateToolbar(false);if(o){this._moveControlInSuitableCollection(o,this._getControlPriority(o))}this._informNewFlexibleContentAdded(o);const t=this._callToolbarMethod("insertAggregation",arguments);this._updateSeparators();return t}return e.prototype.insertAggregation.apply(this,arguments)};l.prototype.removeAllAggregation=function(t){if(t==="content"){throw new Error("Mutator functions of the content aggregation of the ActionToolbar '"+this.getId()+"' must not be used.")}return e.prototype.removeAllAggregation.apply(this,arguments)};l.prototype.removeAggregation=function(t,o){if(t==="content"){throw new Error("Mutator functions of the content aggregation of the ActionToolbar '"+this.getId()+"' must not be used.")}if(u.includes(t)){const t=this._callToolbarMethod("removeAggregation",arguments);if(t){this._getPopover().removeAssociatedContent(t.getId())}this._resetAndInvalidateToolbar(false);this._deregisterControlListener(t);this._removeContentFromControlsCollections(t);this._updateSeparators();return t}return e.prototype.removeAggregation.apply(this,arguments)};l.prototype.setUseAsHeader=function(t){this.setProperty("useAsHeader",t,true);this.toggleStyleClass("sapMTBHeader-CTX",!!t);return this};l.prototype.getEndActionsBegin=function(){return this.getActionsWithLayoutInformation({aggregationName:"end",alignment:s.Begin})};l.prototype.getEndActionsEnd=function(){return this.getActionsWithLayoutInformation({aggregationName:"end",alignment:s.End})};l.prototype.getActionsWithLayoutInformation=function(t){return this.getActions().filter(e=>{const o=e.getLayoutInformation();return o.aggregationName===t.aggregationName&&o.alignment===t.alignment})};l.prototype.onAfterRendering=function(){e.prototype.onAfterRendering.apply(this,arguments);this._updateSeparators()};l.prototype._onContentPropertyChangedOverflowToolbar=function(t){if(this._bIsBeingDestroyed){return}e.prototype._onContentPropertyChangedOverflowToolbar.apply(this,arguments);if(t.getParameter("name")==="visible"||t.getParameter("name")==="width"&&t.getSource()!=this._oBeginSeparator){this._updateSeparators()}};l.prototype._hasVisible=function(t){const e=this.getAggregation("_popover")?this.getAggregation("_popover")._getAllContent():[];const o=t.filter(t=>e.indexOf(t)===-1);return o.some(t=>{const e=t.getWidth?t.getWidth()!=="0px":true;if(t.isA("sap.ui.mdc.actiontoolbar.ActionToolbarAction")){return t.getVisible()&&e&&t.getAction()?.getVisible()}return t.getVisible()&&e})};l.prototype._updateSeparators=function(){const t=this._hasVisible(this.getEnd());const e=(t,e)=>{if(t.getVisible()!==e){t.setVisible(e);t.invalidate()}};if(this._oBeginSeparator){const t=this._hasVisible(this.getBegin());const o=this._hasVisible(this.getBetween());e(this._oBeginSeparator,t&&o)}if(this._oEndActionsBeginSeparator){const o=this._hasVisible(this.getEndActionsBegin());e(this._oEndActionsBeginSeparator,t&&o)}if(this._oEndActionsEndSeparator){const o=this._hasVisible(this.getEndActionsEnd());e(this._oEndActionsEndSeparator,t&&o)}};l.prototype._getGroupSeparator=function(e){const o=`${this.getId()}-${e}-separator`;let n=t.getElementById(o);if(!n){n=new i(o);this.addDependent(n)}return n};l.prototype._insertGroupSeparators=function(t){const e=t.filter(t=>t.getVisible());e.forEach((o,n)=>{const i=e[n+1];if(!i){return}const r=h(o);const s=h(i);if(r!==s){const e=this._getGroupSeparator(r);const n=t.indexOf(o);t.splice(n+1,0,e)}})};l.prototype.indexOfContent=function(t){return this.getContent().indexOf(t)};l.prototype.getContent=function(){const t=[...this.getEnd(),...this.getControlActions()];const e=t.sort(f);l.ShowGroupSeparators&&this._insertGroupSeparators(e);return[...this.getBegin(),this._oBeginSeparator,...this.getBetween(),this._oSpacer,...this.getEndActionsBegin(),this._oEndActionsBeginSeparator,...e,this._oEndActionsEndSeparator,...this.getEndActionsEnd()]};l.prototype.getCurrentState=function(){const t=[];let e;this.getActions().forEach((o,n)=>{e=o&&o.getId();if(o.getVisible()){t.push({key:e,name:e,alignment:o.getLayoutInformation().alignment})}});return{items:t}};l.prototype.initPropertyHelper=async function(){const t=await Promise.all(this.getActions().map(async t=>{const e=await t.getAction().getMetadata().loadDesignTime(t);const o=this._getEnabledFromDesignTime(e);return{name:t.getId(),alignment:t.getLayoutInformation().alignment,label:t.getLabel(),visible:true,enabled:o}}));return Promise.resolve({getProperties:()=>t})};l.prototype._getEnabledFromDesignTime=function(t){if(!t||!("actions"in t)){return true}if(t.actions==="not-adaptable"){return false}if(t.actions.reveal===null){return"visibility"}if(t.actions.remove===null){return"visibility"}return true};p.call(l.prototype);return l});
//# sourceMappingURL=ActionToolbar.js.map