/*!
 * OpenUI5
 * (c) Copyright 2026 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/isEmptyObject","sap/base/Log","sap/m/MessageBox","sap/ui/core/mvc/XMLView","sap/ui/core/support/Plugin","sap/ui/core/support/Support","sap/ui/core/util/File","sap/ui/fl/support/diagnostics/FlexibilityDataExtractor","sap/ui/model/json/JSONModel"],function(t,i,e,o,a,s,l,n,r){"use strict";const p=a.extend("sap.ui.fl.support.diagnostics.FlexibilityPlugin",{constructor:function(t){a.apply(this,["sapUiSupportFlexibilityPlugin","Flexibility",t]);this._oStub=t;if(this.runsAsToolPlugin()){this._aEventIds=[`${this.getId()}SetData`]}else{this._aEventIds=[`${this.getId()}GetData`]}}});async function u(){this.oView=await o.create({viewName:"sap.ui.fl.support.diagnostics.Flexibility",viewData:{plugin:this}});this.oView.placeAt(this.$().get(0));this.oView.setModel(this.oFlexDataModel,"flexData");this.oView.setModel(this.oToolSettingsModel,"flexToolSettings")}p.prototype.init=function(t,...i){a.prototype.init.apply(this,[t,...i]);if(t.isToolStub()){this.oFlexDataModel=new r;this.oToolSettingsModel=new r({anonymizeData:true});u.call(this)}};p.prototype.sendGetDataEvent=function(t){s.getStub().sendEvent(`${this.getId()}GetData`,{anonymizeData:t})};p.prototype.onsapUiSupportFlexibilityPluginGetData=async function(t){try{const i=t.getParameter("anonymizeData");const e=await n.extractFlexibilityData(i);this._oStub.sendEvent(`${this.getId()}SetData`,e)}catch(t){e.error("Flexibility data could not be retrieved");i.error("Error extracting flexibility data: ",t)}};p.prototype.onsapUiSupportFlexibilityPluginSetData=function(i){const o=i.getParameters();this.oFlexDataModel.setData(o);const a=this.oFlexDataModel.getData();if(t(a)){e.error("Flexibility data could not be retrieved");return}try{const t=JSON.stringify(a,null,2);l.save(t,"flexibilitySupportData","json")}catch(t){e.error("Error downloading flexibility support data")}};p.prototype.exit=function(...t){this.oView?.destroy();this.oFlexDataModel?.destroy();this.oToolSettingsModel?.destroy();a.prototype.exit.apply(this,t)};return p});
//# sourceMappingURL=FlexibilityPlugin.js.map