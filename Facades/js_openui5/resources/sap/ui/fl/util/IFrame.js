/*!
 * OpenUI5
 * (c) Copyright 2026 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Control","sap/ui/model/json/JSONModel","sap/ui/fl/util/getContainerUserInfo","sap/base/security/URLListValidator","sap/base/Log","sap/ui/fl/util/IFrameRenderer","sap/ui/core/library"],function(e,t,r,i,o,s){"use strict";function a(e){if(e.parts&&e.formatter){return e.formatter.apply(null,e.parts.map(function(e){if(e.model){return`{${e.model}>${e.path}}`}return`{${e.path}}`}))}return e}var n=e.extend("sap.ui.fl.util.IFrame",{metadata:{library:"sap.ui.fl",properties:{url:{type:"sap.ui.core.URI",group:"Misc",defaultValue:"about:blank"},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"35vh"},title:{type:"string",group:"Misc",defaultValue:undefined},asContainer:{type:"boolean",group:"Misc",defaultValue:undefined},renameInfo:{type:"object",group:"Data",defaultValue:null},advancedSettings:{type:"object",defaultValue:{allowForms:true,allowPopups:true,allowScripts:true,allowModals:true,allowSameOrigin:true,additionalSandboxParameters:[]}},_settings:{type:"object",group:"Data",defaultValue:null}},designtime:"sap/ui/fl/designtime/util/IFrame.designtime"},init(...i){if(e.prototype.init){e.prototype.init.apply(this,i)}this._oInitializePromise=r().then(function(e){this._oUserModel=new t(e);this.setModel(this._oUserModel,"$user")}.bind(this))},waitForInit(){return this._oInitializePromise?this._oInitializePromise:Promise.reject()},setUrl(e){let t=decodeURI(e)===e?encodeURI(e):e;t||="about:blank";if(!n.isValidUrl(t).result){o.error("Provided URL is not valid as an IFrame src");return this}const r=n._toUrl(t);this.setProperty("url",r.toString());return this},getIFrameDomRef(){return this.getDomRef()?.querySelector("iframe")},getFocusDomRef(){return this.getIFrameDomRef()},applySettings(t,...r){const{url:i,...o}=t||{};e.prototype.applySettings.apply(this,[o,...r]);e.prototype.applySettings.apply(this,[{url:i},...r]);if(t){let e={...this.getProperty("_settings")||{}};if(t._settings){e={...e,...t._settings}}else{Object.keys(t).filter(function(e){return t[e]!==undefined}).forEach(function(r){e[r]=a(t[r])})}this.setProperty("_settings",{...e})}},exit(){if(this._oUserModel){this._oUserModel.destroy();delete this._oUserModel}},renderer:s});n._getDocumentLocation=function(){return document.location};n._toUrl=function(e){const t=n._getDocumentLocation();return new URL(e,t.href)};n.VALIDATION_ERROR={UNSAFE_PROTOCOL:"unsafeProtocol",MIXED_CONTENT:"mixedContent",FORBIDDEN_URL:"forbiddenUrl",INVALID_URL:"invalidUrl"};n.isValidUrl=function(e){try{if(e==="about:blank"){return{result:true}}const t=n._toUrl(e);if(/javascript/i.test(t.protocol)){return{result:false,error:n.VALIDATION_ERROR.UNSAFE_PROTOCOL}}if(/http(?!s)/.test(t.protocol)&&!/http(?!s)/.test(n._getDocumentLocation().protocol)){return{result:false,error:n.VALIDATION_ERROR.MIXED_CONTENT}}if(!i.validate(e)){return{result:false,error:n.VALIDATION_ERROR.FORBIDDEN_URL}}return{result:true}}catch{return{result:false,error:n.VALIDATION_ERROR.INVALID_URL}}};return n});
//# sourceMappingURL=IFrame.js.map